<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>5G88 Game Logo</title>
  <link rel="stylesheet" href="assest/logogame.css">
  <style>html{visibility:hidden}</style>
<script>
(function(){
  // ====== KONFIG ======
  const LOGIN_URL = "https://5g88-login.vercel.app/";
  const ALLOWED_PARENTS = new Set([
    "https://searcfile.github.io",
    "https://5g88-main.vercel.app",
  ]);
  const TIMEOUT_MS = 3500; // lebih longgar

  // redirect helper (samakan param dengan parent: ?redirect=)
  function goLogin(){
    const rt = encodeURIComponent(location.href);
    location.replace(`${LOGIN_URL}?redirect=${rt}`);
  }

  // Jika dibuka langsung (bukan di iframe) â†’ paksa login page
  if (window.top === window.self) { goLogin(); return; }

  let authed = false;
  let timeoutId = null;

  // Minta parent kirim data login (handshake)
  function requestLoginFromParent(){
    try {
      window.parent.postMessage({ type: "request-login" }, "*");
      window.parent.postMessage({ type: "child-ready" }, "*");
    } catch(_) {}
  }

  function onMsg(ev){
    // Validasi origin dulu
    if (!ALLOWED_PARENTS.has(ev.origin)) return;

    const d = ev.data || {};
    if (d.type === "user-login" && d.user && typeof d.user.email === "string") {
      authed = true;
      try { sessionStorage.setItem("child_login_user", d.user.email.toLowerCase()); } catch(_){}
      document.documentElement.style.visibility = "visible";
      window.removeEventListener("message", onMsg);
      if (timeoutId) clearTimeout(timeoutId);
    }
  }

  window.addEventListener("message", onMsg, false);
  requestLoginFromParent();

  // fallback: kalau parent tidak kirim-kirim, redirect ke login
  timeoutId = setTimeout(() => {
    if (!authed) {
      window.removeEventListener("message", onMsg);
      goLogin();
    }
  }, TIMEOUT_MS);
})();
</script>

</head>
<body>
  <div class="header">ðŸŽ° LOGO GAME ðŸŽ°</div>

  <div class="filter-bar">
  <div class="search-container">
    <input type="text" id="searchInput" placeholder="Search Favorite Game" onkeyup="filterGames()" />
  </div>

  <div class="filter-tabs">
    <button onclick="setFilter('all')" class="active">All</button>
    <button onclick="setFilter('slot')">Slot</button>
    <button onclick="setFilter('live')">Live Game</button>
    <button onclick="setFilter('table')">Table Game</button>
  </div>

  <div class="filter-tabs platform-filters">
    <button onclick="setPlatform('all')" class="active">All Platforms</button>
    <button onclick="setPlatform('918kiss')">918kiss</button>
    <button onclick="setPlatform('mega888')">MEGA888</button>
    <button onclick="setPlatform('pussy888')">PUSSY888</button>
    <button onclick="setPlatform('xe88')">XE88</button>
  </div>
</div>

  <div class="logo-grid" id="gameGrid">
  </div>
  <button id="backToTop" onclick="scrollToTop()">â¬† Back to Top</button>
  <script src="assestman/logogame.js"></script>
</body>
</html>
