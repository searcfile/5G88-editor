<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Game Log Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    body {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-family: 'Source Sans 3', 'Source Sans Pro', Arial, sans-serif;
      padding: 20px;
      font-size: 14px;
      line-height: 1.42857;
      color: rgb(51, 51, 51);
      font-weight: 400;
    }
    table {
      width: 65%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 26px;
    }
    th {
      padding: 22px 26px;
      border: 2.5px solid #ddd;
      background: #3c8dbc;
      color: white;
      text-align: center;
    }
    td {
      padding: 22px 26px;
      border: 1px solid rgba(0, 0, 0, 0.05);
      text-align: center;
      white-space: nowrap;
    }
    #gameLog tbody td {
      padding-top: 10px;
      padding-bottom: 10px;
      line-height: 1.1;
    }
    .log-row {
      color: rgb(51, 51, 51);
      font-size: 26px; 
      white-space: nowrap;
    }
    th:nth-child(2),
    td:nth-child(2) {
      width: 50px;
    }
    .table-id-highlight {
      width: 36.5px;
      height: 32.5px;
      background-color: #d2d6de;
      color: #000;
      font-weight: bold;
      font-size: 24px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 10px auto;
    }
    button {
      padding: 5px 10px;
      font-size: 14px;
      margin-top: 10px;
      margin-right: 10px;
      background: #28a745;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #218838;
    }
    select, input {
      padding: 3px 6px;
      font-size: 13px;
      margin-left: 10px;
    }
    #nowTime {
      font-weight: bold;
      margin-left: 10px;
      color: #0073e6;
    }
  </style>
</head>
<body>
   <h2>Game Log Generator</h2>

<div style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap; margin-bottom: 15px;">
  <label for="gameSelect">Game:</label>
  <select id="gameSelect" style="height: 38px; font-size: 16px;">
    <option value="">-- Pilih Game --</option>
    <option value="Great88">Great88</option>
    <option value="LuckyBall">LuckyBall</option>
  </select>

  <label for="betSelect">Bet:</label>
  <select id="betSelect" style="height: 38px; font-size: 16px;"></select>

  <label for="pecahanSelect">Pecahan:</label>
  <select id="pecahanSelect" style="height: 38px; font-size: 16px;"></select>
</div>

<div style="margin-bottom: 10px;">
  <button onclick="setNow()" style="height: 48px; padding: 6px 12px; font-size: 16px;">Click Now</button>
  <label for="manualTime" style="margin-left: 20px;">Set Time:</label>
  <input type="text" id="manualTime" placeholder="YYYY-MM-DD HH:MM:SS"
         style="width: 240px; font-size: 22px; padding: 6px 12px; height: 38px;" />
</div>

<div style="margin-bottom: 10px;">
  <button id="btnChange" style="height: 48px;">Change</button>
  <label for="initialBalance" style="font-size: 16px; margin-left: 20px;">Initial Balance:</label>
  <input type="number" id="initialBalance" value="3500" step="0.01" style="width: 150px; font-size: 16px; padding: 5px;" />
</div>

<table id="gameLog">
  <thead>
    <tr>
      <th>GameName</th>
      <th>TableID</th>
      <th>Bet</th>
      <th>Win</th>
      <th>BeginMoney</th>
      <th>EndMoney</th>
      <th>DateTime</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
  let globalTime = null;
  const gameData = {
    Great88: {
      bets: [1.25, 1.75, 2.50, 3.00, 3.75, 5.00, 7.50, 12.50, 15.00, 25.00],
      pecahan: {
        1.25: [2.00, 4.00, 6.00, 8.00, 10.00, 12.50],
        1.75: [10.00, 20.00, 30.00, 40.00, 50.00],
        2.50: [20.00, 40.00, 60.00, 80.00],
        3.00: [30.00, 60.00, 90.00, 120.00],
        3.75: [40.00, 80.00, 120.00, 160.00],
        5.00: [10.00, 20.00, 30.00, 40.00, 50.00],
        7.50: [10.00, 20.00, 30.00, 40.00, 50.00],
        12.50: [10.00, 20.00, 30.00, 40.00, 50.00],
        15.00: [10.00, 20.00, 30.00, 40.00, 50.00],
        25.00: [10.00, 20.00, 30.00, 40.00, 50.00]
      }
    },
    LuckyBall: {
      bets: [2.50, 5.00],
      pecahan: {
        2.50: [25.00, 50.00, 75.00, 100.00],
        5.00: [50.00, 100.00, 150.00, 200.00]
      }
    }
  };

  function formatDateTimeLocal(d) {
    if (!d) return '';
    const pad = (n) => n.toString().padStart(2, '0');
    return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
  }

  // Parsing manual input "YYYY-MM-DD HH:mm:ss"
  function parseManualTime(str) {
    if (!str) return null;
    const parts = str.trim().split(" ");
    if (parts.length !== 2) return null;
    const [datePart, timePart] = parts;
    const dateParts = datePart.split("-");
    const timeParts = timePart.split(":");
    if (dateParts.length !== 3 || timeParts.length !== 3) return null;

    const year = parseInt(dateParts[0], 10);
    const month = parseInt(dateParts[1], 10) - 1;
    const day = parseInt(dateParts[2], 10);
    const hours = parseInt(timeParts[0], 10);
    const minutes = parseInt(timeParts[1], 10);
    const seconds = parseInt(timeParts[2], 10);

    const d = new Date(year, month, day, hours, minutes, seconds);
    return isNaN(d.getTime()) ? null : d;
  }

  // Mengisi opsi betSelect sesuai game
  function fillBetOptions(game) {
    const betSelect = document.getElementById('betSelect');
    betSelect.innerHTML = '';
    if (!game || !gameData[game]) return;
    for (const bet of gameData[game].bets) {
      const opt = document.createElement('option');
      opt.value = bet;
      opt.textContent = bet.toFixed(2);
      betSelect.appendChild(opt);
    }
  }

  // Mengisi opsi pecahanSelect sesuai bet dan game
  function fillPecahanOptions(game, bet) {
    const pecahanSelect = document.getElementById('pecahanSelect');
    pecahanSelect.innerHTML = '';
    if (!game || !bet || !gameData[game]) return;
    const pecahanArr = gameData[game].pecahan[bet];
    if (!pecahanArr) return;
    for (const p of pecahanArr) {
      const opt = document.createElement('option');
      opt.value = p;
      opt.textContent = p.toFixed(2);
      pecahanSelect.appendChild(opt);
    }
  }

  // Set waktu sekarang dan update input manualTime
  function setNow() {
    globalTime = new Date();
    document.getElementById("manualTime").value = formatDateTimeLocal(globalTime);
    generateLog();
  }

  // Generate log table
  function generateLog() {
    const tbody = document.querySelector("#gameLog tbody");
    tbody.innerHTML = "";

    const game = document.getElementById("gameSelect").value;
    const bet = parseFloat(document.getElementById("betSelect").value);
    const pecahan = parseFloat(document.getElementById("pecahanSelect").value);
    const initialBalance = parseFloat(document.getElementById("initialBalance").value) || 0;

    if (!game || isNaN(bet) || isNaN(pecahan)) return;

    // Ambil waktu dari manual input atau globalTime
    let currentTime = parseManualTime(document.getElementById("manualTime").value) || globalTime || new Date();

    let balance = initialBalance;
    for (let i = 1; i <= 10; i++) {
      const beginMoney = balance;
      const win = -pecahan; // Win selalu negatif pecahan
      const endMoney = beginMoney + win;

      // Waktu maju tiap menit
      const logTime = new Date(currentTime.getTime() + (i - 1) * 60000);
      const dateTimeStr = formatDateTimeLocal(logTime);

      const tr = document.createElement("tr");
      tr.classList.add("log-row");

      const tdGameName = document.createElement("td");
      tdGameName.textContent = game;

      const tdTableID = document.createElement("td");
      tdTableID.innerHTML = `<div class="table-id-highlight">${i}</div>`;

      const tdBet = document.createElement("td");
      tdBet.textContent = bet.toFixed(2);

      const tdWin = document.createElement("td");
      tdWin.textContent = win.toFixed(2);

      const tdBeginMoney = document.createElement("td");
      tdBeginMoney.textContent = beginMoney.toFixed(2);

      const tdEndMoney = document.createElement("td");
      tdEndMoney.textContent = endMoney.toFixed(2);

      const tdDateTime = document.createElement("td");
      tdDateTime.textContent = dateTimeStr;

      tr.appendChild(tdGameName);
      tr.appendChild(tdTableID);
      tr.appendChild(tdBet);
      tr.appendChild(tdWin);
      tr.appendChild(tdBeginMoney);
      tr.appendChild(tdEndMoney);
      tr.appendChild(tdDateTime);

      tbody.appendChild(tr);

      balance = endMoney;
    }
  }

  // Event listeners untuk perubahan select
  document.getElementById('gameSelect').addEventListener('change', (e) => {
    const game = e.target.value;
    fillBetOptions(game);
    document.getElementById('pecahanSelect').innerHTML = '';
    generateLog();
  });

  document.getElementById('betSelect').addEventListener('change', (e) => {
    const bet = parseFloat(e.target.value);
    const game = document.getElementById('gameSelect').value;
    fillPecahanOptions(game, bet);
    generateLog();
  });

  document.getElementById('pecahanSelect').addEventListener('change', generateLog);

  document.getElementById('btnChange').addEventListener('click', generateLog);

  // Inisialisasi kosong bet dan pecahan saat awal load
  document.getElementById('betSelect').innerHTML = '';
  document.getElementById('pecahanSelect').innerHTML = '';

</script>
</body>
</html>
